##### –î–ó –¢–µ–º–∞ 9. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, –¢–µ–º–∞ 10. –í—Å—Ç—É–ø –¥–æ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å


##### –¢–µ–º–∞ 10. –í—Å—Ç—É–ø –¥–æ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å

### –ó–∞–≤–¥–∞–Ω–Ω—è 2

'''
–ù–∞–ø–∏—à—ñ—Ç—å Python-—Å–∫—Ä–∏–ø—Ç, —è–∫–∏–π –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ç–µ–∫—Å—Ç —ñ–∑ –∑–∞–¥–∞–Ω–æ—ó URL-–∞–¥—Ä–µ—Å–∏, 
–∞–Ω–∞–ª—ñ–∑—É—î —á–∞—Å—Ç–æ—Ç—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ª—ñ–≤ —É —Ç–µ–∫—Å—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –ø–∞—Ä–∞–¥–∏–≥–º–∏ MapReduce 
—ñ –≤—ñ–∑—É–∞–ª—ñ–∑—É—î —Ç–æ–ø-—Å–ª–æ–≤–∞ –∑ –Ω–∞–π–≤–∏—â–æ—é —á–∞—Å—Ç–æ—Ç–æ—é –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —É —Ç–µ–∫—Å—Ç—ñ.

–ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è

1. –Ü–º–ø–æ—Ä—Ç—É–π—Ç–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –º–æ–¥—É–ª—ñ (matplotlib —Ç–∞ —ñ–Ω—à—ñ).
2. –í—ñ–∑—å–º—ñ—Ç—å –∫–æ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó MapReduce –∑ –∫–æ–Ω—Å–ø–µ–∫—Ç—É.
3. –°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é visualize_top_words –¥–ª—è –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
4. –£ –≥–æ–ª–æ–≤–Ω–æ–º—É –±–ª–æ—Ü—ñ –∫–æ–¥—É –æ—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞ URL, –∑–∞—Å—Ç–æ—Å—É–π—Ç–µ MapReduce —Ç–∞ –≤—ñ–∑—É–∞–ª—ñ–∑—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.
üëâüèº –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è —Ç–æ–ø 10 –Ω–∞–π—á–∞—Å—Ç—ñ—à–µ –≤–∂–∏–≤–∞–Ω–∏—Ö —Å–ª—ñ–≤ –ø–æ–±—É–¥–æ–≤–∞ –≥—Ä–∞—Ñ—ñ–∫–∞ –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ —Ç–∞–∫:

–ö—Ä–∏—Ç–µ—Ä—ñ—ó –ø—Ä–∏–π–Ω—è—Ç—Ç—è

- –ö–æ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ç–µ–∫—Å—Ç —ñ–∑ –∑–∞–¥–∞–Ω–æ—ó URL-–∞–¥—Ä–µ—Å–∏.
- –ö–æ–¥ –≤–∏–∫–æ–Ω—É—î –∞–Ω–∞–ª—ñ–∑ —á–∞—Å—Ç–æ—Ç–∏ —Å–ª—ñ–≤ —ñ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º MapReduce.
- –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —Ç–æ–ø-—Å–ª–æ–≤–∞ –∑–∞ —á–∞—Å—Ç–æ—Ç–æ—é –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.
- –ö–æ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤—ñ—Å—Ç—å.
- –ö–æ–¥ —á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PEP 8.
'''

import string
from concurrent.futures import ThreadPoolExecutor
from collections import defaultdict, Counter

import matplotlib.pyplot as plt
import requests


def get_text(url):
    #TODO –î–æ–¥–∞—Ç–∏ –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫
    try: 
        response = requests.get(url)
        response.raise_for_status()  # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ø–æ–º–∏–ª–∫–∏ HTTP - response.raise_for_status(): –¶–µ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Å—Ç–∞—Ç—É—Å-–∫–æ–¥ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. - –Ø–∫—â–æ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥ –≤–∫–∞–∑—É—î –Ω–∞ —É—Å–ø—ñ—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 200 OK), —Ç–æ –º–µ—Ç–æ–¥ –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç—å, —ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä—è–¥–∫–∞. - –Ø–∫—â–æ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥ –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ–º–∏–ª–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 404 Not Found –∞–±–æ 500 Internal Server Error), —Ç–æ —Ü–µ–π –º–µ—Ç–æ–¥ –≤–∏–∫–ª–∏–∫–∞—î –≤–∏–Ω—è—Ç–æ–∫ requests.HTTPError. –¶–µ–π –≤–∏–Ω—è—Ç–æ–∫ –±—É–¥–µ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–∏–π –±–ª–æ–∫–æ–º except, —ñ —Ñ—É–Ω–∫—Ü—ñ—è –ø–æ–≤–µ—Ä–Ω–µ None.
        return response.text
    except requests.RequestException as e:
        print(f'- Error of access to url: {e}')



# –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑–Ω–∞–∫—ñ–≤ –ø—É–Ω–∫—Ç—É–∞—Ü—ñ—ó
def remove_punctuation(text):
    return text.translate(str.maketrans("", "", string.punctuation))


def map_function(word):
    return word, 1


def shuffle_function(mapped_values):
    shuffled = defaultdict(list)
    for key, value in mapped_values:
        shuffled[key].append(value)
    return shuffled.items()

#TODO –î–æ–ø–∏—Å–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é reduce_function
def reduce_function(key_values):
    key, values = key_values
    return key, sum(values)


# –í–∏–∫–æ–Ω–∞–Ω–Ω—è MapReduce
def map_reduce(text, search_words=None):
    text = remove_punctuation(text)
    words = text.split()

    # –Ø–∫—â–æ –∑–∞–¥–∞–Ω–æ —Å–ø–∏—Å–æ–∫ —Å–ª—ñ–≤ –¥–ª—è –ø–æ—à—É–∫—É, –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ —Ç—ñ–ª—å–∫–∏ —Ü—ñ —Å–ª–æ–≤–∞
    if search_words:
        words = [word for word in words if word in search_words]

    # –ö—Ä–æ–∫ 1: –í–∏–∫–æ–Ω–∞—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π –º–∞–ø–ø—ñ–Ω–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–≤—à–∏ ThreadPoolExecutor()
    with ThreadPoolExecutor() as executor:
        mapped_values = list(executor.map(map_function, words))

    # –ö—Ä–æ–∫ 2: Shuffle
    shuffled_values = shuffle_function(mapped_values)

    # –ö—Ä–æ–∫ 3: –í–∏–∫–æ–Ω–∞—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—É —Ä–µ–¥—É–∫—Ü—ñ—é –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–≤—à–∏ ThreadPoolExecutor()
    with ThreadPoolExecutor() as executor:
        reduced_values = list(executor.map(reduce_function, shuffled_values))

    return dict(reduced_values)


def visualize_top_words(result, top_n=10):
    # –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ–ø-N –Ω–∞–π—á–∞—Å—Ç—ñ—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏—Ö —Å–ª—ñ–≤
    top_words = Counter(result).most_common(top_n)  # –°–ø–∏—Å–æ–∫ –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–∏–π –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —É –ø–æ—Ä—è–¥–∫—É —Å–ø–∞–¥–∞–Ω–Ω—è (–≤—ñ–¥ –Ω–∞–π–±—ñ–ª—å—à–æ—ó –¥–æ –Ω–∞–π–º–µ–Ω—à–æ—ó). –ê—Ä–≥—É–º–µ–Ω—Ç top_n (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 10) –≤–∫–∞–∑—É—î, —Å–∫—ñ–ª—å–∫–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏. –†–µ–∑—É–ª—å—Ç–∞—Ç: –ó–º—ñ–Ω–Ω—ñ–π top_words –ø—Ä–∏—Å–≤–æ—é—î—Ç—å—Å—è —Å–ø–∏—Å–æ–∫, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: [('—Å–ª–æ–≤–æ_–ê', 50), ('—Å–ª–æ–≤–æ_–ë', 45), ('—Å–ª–æ–≤–æ_–í', 30), ...]

    # –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –Ω–∞ —Å–ª–æ–≤–∞ —Ç–∞ —ó—Ö —á–∞—Å—Ç–æ—Ç–∏
    words, counts = zip(*top_words)                 # zip –ø–æ–≤–µ—Ä—Ç–∞—î —ñ—Ç–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –ø—ñ—Å–ª—è —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –Ω–∞ –¥–≤—ñ –∑–º—ñ–Ω–Ω—ñ —Å—Ç–≤–æ—Ä—é—î: words = ('—Å–ª–æ–≤–æ_–ê', '—Å–ª–æ–≤–æ_–ë', '—Å–ª–æ–≤–æ_–í', ...); counts = (50, 45, 30, ...)

    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫–∞
    plt.figure(figsize=(10, 6))
    plt.barh(words, counts, color='skyblue')
    plt.xlabel('Frequency')
    plt.ylabel('Words')
    plt.title('Top {} Most Frequent Words'.format(top_n))
    plt.gca().invert_yaxis()  # –ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫, —â–æ–± –Ω–∞–π–±—ñ–ª—å—à—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –±—É–ª–∏ –∑–≤–µ—Ä—Ö—É
    plt.show()



if __name__ == '__main__':
    # –í—Ö—ñ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è –æ–±—Ä–æ–±–∫–∏
    url = "https://gutenberg.net.au/ebooks01/0100021.txt"
    text = get_text(url)
    # –í–∏–∫–æ–Ω–∞–Ω–Ω—è MapReduce –Ω–∞ –≤—Ö—ñ–¥–Ω–æ–º—É —Ç–µ–∫—Å—Ç—ñ
    result = map_reduce(text)
    visualize_top_words(result)

    # –î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞ —É–º–æ–≤—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PEP8 —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ pycodestyle
    # –ü—Ä–∏–∫–ª–∞–¥ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è "pycodestyle --show-source --show-pep8 exercise_10_mapreduce.py"

'''
–¶–µ–π –∫–æ–¥ —î –∫–æ–º–ø–ª–µ–∫—Å–Ω–∏–º –ø—Ä–∏–∫–ª–∞–¥–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞—Ä–∞–¥–∏–≥–º–∏ MapReduce –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É —Ç–µ–∫—Å—Ç—É. –í—ñ–Ω –æ—Ç—Ä–∏–º—É—î —Ç–µ–∫—Å—Ç –∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É, –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—Ö–æ–¥–∂–µ–Ω—å –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ–≤–∞, –∞ –ø–æ—Ç—ñ–º –≤—ñ–∑—É–∞–ª—ñ–∑—É—î –Ω–∞–π—á–∞—Å—Ç—ñ—à—ñ —Å–ª–æ–≤–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≥—Ä–∞—Ñ—ñ–∫–∞. –ö–ª—é—á–æ–≤–æ—é –æ—Å–æ–±–ª–∏–≤—ñ—Å—Ç—é —î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **–ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º—É** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `ThreadPoolExecutor` –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –æ–±—á–∏—Å–ª–µ–Ω—å.

-----

### –ü–æ–∫—Ä–æ–∫–æ–≤–∏–π —Ä–æ–∑–±—ñ—Ä –∫–æ–¥—É

#### 1\. –Ü–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫


import string
from concurrent.futures import ThreadPoolExecutor
from collections import defaultdict, Counter

import matplotlib.pyplot as plt
import requests
```

  * **`string`**: –ú–æ–¥—É–ª—å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —Ä—è–¥–∫–∞–º–∏, –º—ñ—Å—Ç–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É `string.punctuation` (—Ä–æ–∑–¥—ñ–ª–æ–≤—ñ –∑–Ω–∞–∫–∏).
  * **`ThreadPoolExecutor`**: –ó –º–æ–¥—É–ª—è `concurrent.futures`, –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ –≤ –æ–∫—Ä–µ–º–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö.
  * **`defaultdict`, `Counter`**: –ó –º–æ–¥—É–ª—è `collections`, –Ω–∞–¥–∞—é—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞–Ω–∏—Ö: `defaultdict` –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è, `Counter` –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –µ–ª–µ–º–µ–Ω—Ç—ñ–≤.
  * **`matplotlib.pyplot`**: –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤.
  * **`requests`**: –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è HTTP-–∑–∞–ø–∏—Ç—ñ–≤.

#### 2\. –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

  * **`get_text(url)`**:
      * –û—Ç—Ä–∏–º—É—î —Ç–µ–∫—Å—Ç –∑ URL.
      * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –±–ª–æ–∫ `try...except` –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –º–æ–∂–ª–∏–≤–∏—Ö –ø–æ–º–∏–ª–æ–∫ –∑–∞–ø–∏—Ç—É (`requests.RequestException`).
      * `requests.get(url)` –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç.
      * `response.raise_for_status()` –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Å—Ç–∞—Ç—É—Å-–∫–æ–¥. –Ø–∫—â–æ –≤—ñ–Ω –≤–∫–∞–∑—É—î –Ω–∞ –ø–æ–º–∏–ª–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 404), –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –≤–∏–Ω—è—Ç–æ–∫.
      * –ü–æ–≤–µ—Ä—Ç–∞—î –≤–º—ñ—Å—Ç —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —É –≤–∏–≥–ª—è–¥—ñ —Ä—è–¥–∫–∞ (`response.text`).
  * **`remove_punctuation(text)`**:
      * –ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–¥–∞–ª—è—î –≤—Å—ñ —Ä–æ–∑–¥—ñ–ª–æ–≤—ñ –∑–Ω–∞–∫–∏ –∑ —Ç–µ–∫—Å—Ç—É.
      * `str.maketrans("", "", string.punctuation)` —Å—Ç–≤–æ—Ä—é—î —Ç–∞–±–ª–∏—Ü—é, —è–∫–∞ –≤–∫–∞–∑—É—î –Ω–∞ —Å–∏–º–≤–æ–ª–∏ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è.
      * `text.translate(...)` –∑–∞—Å—Ç–æ—Å–æ–≤—É—î —Ü—é —Ç–∞–±–ª–∏—Ü—é –¥–æ —Ä—è–¥–∫–∞.
  * **`map_function(word)`**:
      * –†–µ–∞–ª—ñ–∑—É—î –µ—Ç–∞–ø **Map**.
      * –ü—Ä–∏–π–º–∞—î –æ–¥–Ω–µ —Å–ª–æ–≤–æ.
      * –ü–æ–≤–µ—Ä—Ç–∞—î –ø–∞—Ä—É `(—Å–ª–æ–≤–æ, 1)`, —â–æ —î –±–∞–∑–æ–≤–æ—é –æ–¥–∏–Ω–∏—Ü–µ—é –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É.
  * **`shuffle_function(mapped_values)`**:
      * –†–µ–∞–ª—ñ–∑—É—î –µ—Ç–∞–ø **Shuffle**.
      * –ü—Ä–∏–π–º–∞—î —Å–ø–∏—Å–æ–∫ –ø–∞—Ä `(—Å–ª–æ–≤–æ, 1)`.
      * –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `defaultdict(list)` –≥—Ä—É–ø—É—î –≤—Å—ñ –∑–Ω–∞—á–µ–Ω–Ω—è `1` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –≤ –æ–∫—Ä–µ–º–∏–π —Å–ø–∏—Å–æ–∫.
      * –ü–æ–≤–µ—Ä—Ç–∞—î —ñ—Ç–µ—Ä–∞—Ç–æ—Ä –∑ –ø–∞—Ä–∞–º–∏ `(—Å–ª–æ–≤–æ, [1, 1, 1...])`.
  * **`reduce_function(key_values)`**:
      * –†–µ–∞–ª—ñ–∑—É—î –µ—Ç–∞–ø **Reduce**.
      * –ü—Ä–∏–π–º–∞—î –æ–¥–Ω—É –ø–∞—Ä—É `(—Å–ª–æ–≤–æ, —Å–ø–∏—Å–æ–∫_–æ–¥–∏–Ω–∏—Ü—å)`.
      * –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `sum()` –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –∑–∞–≥–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ `1`, —Ç–æ–±—Ç–æ –∑–∞–≥–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –≤—Ö–æ–¥–∂–µ–Ω—å —Å–ª–æ–≤–∞.
      * –ü–æ–≤–µ—Ä—Ç–∞—î —Ñ—ñ–Ω–∞–ª—å–Ω—É –ø–∞—Ä—É `(—Å–ª–æ–≤–æ, –∑–∞–≥–∞–ª—å–Ω–∞_–∫—ñ–ª—å–∫—ñ—Å—Ç—å)`.

#### 3\. –û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞ MapReduce

  * **`map_reduce(text, search_words=None)`**:
      * **–û—á–∏—â–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—É**: `text = remove_punctuation(text)` —Ç–∞ `words = text.split()` –≥–æ—Ç—É—é—Ç—å —Ç–µ–∫—Å—Ç –¥–æ –∞–Ω–∞–ª—ñ–∑—É.
      * **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Å–ª—ñ–≤**: –Ø–∫—â–æ –∑–∞–¥–∞–Ω–æ `search_words`, —Å–ø–∏—Å–æ–∫ —Å–ª—ñ–≤ —Ñ—ñ–ª—å—Ç—Ä—É—î—Ç—å—Å—è.
      * **–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π Map**:
          * `with ThreadPoolExecutor() as executor:` —Å—Ç–≤–æ—Ä—é—î –ø—É–ª –ø–æ—Ç–æ–∫—ñ–≤.
          * `executor.map(map_function, words)` –∑–∞–ø—É—Å–∫–∞—î `map_function` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ.
          * `mapped_values` –∑–±–∏—Ä–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ —Å–ø–∏—Å–æ–∫ `[('—Å–ª–æ–≤–æ', 1), ...]`.
      * **Shuffle**:
          * `shuffled_values = shuffle_function(mapped_values)` –≥—Ä—É–ø—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ Map.
      * **–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π Reduce**:
          * `with ThreadPoolExecutor() as executor:` —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π –ø—É–ª –ø–æ—Ç–æ–∫—ñ–≤.
          * `executor.map(reduce_function, shuffled_values)` –∑–∞–ø—É—Å–∫–∞—î `reduce_function` –¥–ª—è –∫–æ–∂–Ω–æ—ó –≥—Ä—É–ø–∏ —Å–ª—ñ–≤ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ.
          * `reduced_values` –∑–±–∏—Ä–∞—î —Ñ—ñ–Ω–∞–ª—å–Ω—ñ –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫–∏.
      * –ü–æ–≤–µ—Ä—Ç–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –≤–∏–≥–ª—è–¥—ñ —Å–ª–æ–≤–Ω–∏–∫–∞ `{'—Å–ª–æ–≤–æ': –∫—ñ–ª—å–∫—ñ—Å—Ç—å, ...}`.

#### 4\. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É

  * **`visualize_top_words(result, top_n=10)`**:
      * `Counter(result)` –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î —Å–ª–æ–≤–Ω–∏–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –Ω–∞ –æ–±'—î–∫—Ç `Counter`, —â–æ –∑—Ä—É—á–Ω–∏–π –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —á–∞—Å—Ç–æ—Ç.
      * `.most_common(top_n)` –æ—Ç—Ä–∏–º—É—î `top_n` –Ω–∞–π—á–∞—Å—Ç—ñ—à–∏—Ö —Å–ª—ñ–≤.
      * –î–∞–Ω—ñ —Ä–æ–∑–¥—ñ–ª—è—é—Ç—å—Å—è –Ω–∞ —Å–ø–∏—Å–∫–∏ `words` —Ç–∞ `counts`.
      * `matplotlib.pyplot` —Å—Ç–≤–æ—Ä—é—î –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É —Å—Ç–æ–≤–ø—á–∞—Å—Ç—É –¥—ñ–∞–≥—Ä–∞–º—É, —è–∫–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —á–∞—Å—Ç–æ—Ç—É —Å–ª—ñ–≤.

#### 5\. –ì–æ–ª–æ–≤–Ω–∏–π –±–ª–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

  * `if __name__ == '__main__':`: –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É –≤ –ø—Ä–æ–≥—Ä–∞–º—É.
  * `url = "..."`: –ó–º—ñ–Ω–Ω–∞ –∑ URL —Ç–µ–∫—Å—Ç—É –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É.
  * `text = get_text(url)`: –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É.
  * `result = map_reduce(text)`: –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –æ—Å–Ω–æ–≤–Ω–∏–π –ø—Ä–æ—Ü–µ—Å MapReduce.
  * `visualize_top_words(result)`: –í—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≥—Ä–∞—Ñ—ñ–∫ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏.

-----

### –°—Ö–µ–º–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

```markdown
1.  **–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–∏**
    * –í–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±–ª–æ–∫ `if __name__ == '__main__':`.
    * URL –¥–ª—è —Ç–µ–∫—Å—Ç—É –∑–∞–¥–∞—î—Ç—å—Å—è.

2.  **–û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É**
    * –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `get_text(url)`.
    * –ü—Ä–æ–≥—Ä–∞–º–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î HTTP-–∑–∞–ø–∏—Ç, –æ—Ç—Ä–∏–º—É—î —Ç–µ–∫—Å—Ç –∞–±–æ –æ–±—Ä–æ–±–ª—è—î –ø–æ–º–∏–ª–∫—É.
    * –¢–µ–∫—Å—Ç –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É –∑–º—ñ–Ω–Ω—ñ–π `text`.

3.  **–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö**
    * –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `map_reduce(text)`.
    * –¢–µ–∫—Å—Ç –æ—á–∏—â–∞—î—Ç—å—Å—è –≤—ñ–¥ –ø—É–Ω–∫—Ç—É–∞—Ü—ñ—ó, —Ä–æ–∑–¥—ñ–ª—è—î—Ç—å—Å—è –Ω–∞ —Å–ø–∏—Å–æ–∫ —Å–ª—ñ–≤ `words`.

4.  **–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π –ú–∞–ø–ø—ñ–Ω–≥ (ThreadPoolExecutor)**
    * –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –ø—É–ª –ø–æ—Ç–æ–∫—ñ–≤.
    * –ö–æ–∂–Ω–µ —Å–ª–æ–≤–æ –∑—ñ —Å–ø–∏—Å–∫—É `words` –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –≤ `map_function` –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ.
    * –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ `(—Å–ª–æ–≤–æ, 1)` –∑–±–∏—Ä–∞—é—Ç—å—Å—è –≤ —Å–ø–∏—Å–æ–∫ `mapped_values`.
    * –ü—É–ª –ø–æ—Ç–æ–∫—ñ–≤ –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è.

5.  **Shuffle (–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ)**
    * `shuffle_function` –æ—Ç—Ä–∏–º—É—î `mapped_values`.
    * –ì—Ä—É–ø—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∫–ª—é—á–∞–º–∏-—Å–ª–æ–≤–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `defaultdict`.
    * –ü–æ–≤–µ—Ä—Ç–∞—î –∑–≥—Ä—É–ø–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ `(—Å–ª–æ–≤–æ, [1, 1, ...])` –≤ `shuffled_values`.

6.  **–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ –†–µ–¥—É–∫—Ü—ñ—è (ThreadPoolExecutor)**
    * –°—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–æ–≤–∏–π –ø—É–ª –ø–æ—Ç–æ–∫—ñ–≤.
    * –ö–æ–∂–Ω–∞ –∑–≥—Ä—É–ø–æ–≤–∞–Ω–∞ –ø–∞—Ä–∞ `(—Å–ª–æ–≤–æ, —Å–ø–∏—Å–æ–∫_–æ–¥–∏–Ω–∏—Ü—å)` –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –≤ `reduce_function` –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ.
    * `reduce_function` –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î —Å—É–º—É (`sum`).
    * –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ `(—Å–ª–æ–≤–æ, –∫—ñ–ª—å–∫—ñ—Å—Ç—å)` –∑–±–∏—Ä–∞—é—Ç—å—Å—è –≤ —Å–ø–∏—Å–æ–∫ `reduced_values`.
    * –ü—É–ª –ø–æ—Ç–æ–∫—ñ–≤ –∑–∞–∫—Ä–∏–≤–∞—î—Ç—å—Å—è.

7.  **–§–∏–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è**
    * –°–ø–∏—Å–æ–∫ `reduced_values` –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ —Å–ª–æ–≤–Ω–∏–∫ `result`.

8.  **–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è**
    * –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `visualize_top_words(result)`.
    * `Counter` –≤–∏–∑–Ω–∞—á–∞—î –Ω–∞–π—á–∞—Å—Ç—ñ—à—ñ —Å–ª–æ–≤–∞.
    * `matplotlib` —Å—Ç–≤–æ—Ä—é—î —Ç–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≥—Ä–∞—Ñ—ñ–∫.

9.  **–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–∏**.
```
'''

#### –ø–æ—è—Å–Ω–∏ –±—É–¥—å –ª–∞—Å–∫–∞ —è–∫ –ø—Ä–∞—Ü—é—î —Ü—è —á–∞—Å—Ç–∏–Ω–∞ –∫–æ–¥—É ?

# def visualize_top_words(result, top_n=10):
#     # –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–æ–ø-N –Ω–∞–π—á–∞—Å—Ç—ñ—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏—Ö —Å–ª—ñ–≤
#     top_words = Counter(result).most_common(top_n)

#     # –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –Ω–∞ —Å–ª–æ–≤–∞ —Ç–∞ —ó—Ö —á–∞—Å—Ç–æ—Ç–∏
#     words, counts = zip(*top_words)


# –ü–æ—è—Å–Ω–µ–Ω–Ω—è:

'''
–¶–µ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –∫–æ–¥—É –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–∏—Ö –¥–æ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó. –í—ñ–Ω –±–µ—Ä–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —Å–ª—ñ–≤ —ñ –≤–∏–±–∏—Ä–∞—î –∑ –Ω—å–æ–≥–æ –Ω–∞–π—á–∞—Å—Ç—ñ—à—ñ, –∞ –ø–æ—Ç—ñ–º —Ä–æ–∑–±–∏–≤–∞—î —ó—Ö –Ω–∞ –æ–∫—Ä–µ–º—ñ —Å–ø–∏—Å–∫–∏ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫–∞.

### –ü–æ–∫—Ä–æ–∫–æ–≤–∏–π —Ä–æ–∑–±—ñ—Ä –∫–æ–¥—É

-----

**1. –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–π—á–∞—Å—Ç—ñ—à–∏—Ö —Å–ª—ñ–≤ (`Counter` —Ç–∞ `most_common`)**


top_words = Counter(result).most_common(top_n)
```

  * **`Counter(result)`**:
      * `result` ‚Äî —Ü–µ —Å–ª–æ–≤–Ω–∏–∫, —è–∫–∏–π —Ñ—É–Ω–∫—Ü—ñ—è –æ—Ç—Ä–∏–º—É—î –Ω–∞ –≤—Ö—ñ–¥. –í—ñ–Ω –º–∞—î –≤–∏–≥–ª—è–¥ `{'—Å–ª–æ–≤–æ1': –∫—ñ–ª—å–∫—ñ—Å—Ç—å1, '—Å–ª–æ–≤–æ2': –∫—ñ–ª—å–∫—ñ—Å—Ç—å2, ...}`.
      * **`Counter`** –∑ –º–æ–¥—É–ª—è `collections` ‚Äî —Ü–µ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –∫–ª–∞—Å-—Å–ª–æ–≤–Ω–∏–∫, —è–∫–∏–π —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —Ö–µ—à–æ–≤–∞–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤. –ö–æ–ª–∏ –≤–∏ –ø–µ—Ä–µ–¥–∞—î—Ç–µ –π–æ–º—É –∑–≤–∏—á–∞–π–Ω–∏–π —Å–ª–æ–≤–Ω–∏–∫, –≤—ñ–Ω —Å—Ç–≤–æ—Ä—é—î —Å–≤–æ—é –∫–æ–ø—ñ—é, –∞–ª–µ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏, –∫–æ—Ä–∏—Å–Ω–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏.
  * **`.most_common(top_n)`**:
      * –¶–µ –º–µ—Ç–æ–¥ –æ–±'—î–∫—Ç–∞ `Counter`. –í—ñ–Ω –ø–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂—ñ–≤, –¥–µ –∫–æ–∂–µ–Ω –∫–æ—Ä—Ç–µ–∂ –º—ñ—Å—Ç–∏—Ç—å –µ–ª–µ–º–µ–Ω—Ç —ñ –π–æ–≥–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å.
      * –°–ø–∏—Å–æ–∫ –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–∏–π –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —É –ø–æ—Ä—è–¥–∫—É —Å–ø–∞–¥–∞–Ω–Ω—è (–≤—ñ–¥ –Ω–∞–π–±—ñ–ª—å—à–æ—ó –¥–æ –Ω–∞–π–º–µ–Ω—à–æ—ó).
      * –ê—Ä–≥—É–º–µ–Ω—Ç `top_n` (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `10`) –≤–∫–∞–∑—É—î, —Å–∫—ñ–ª—å–∫–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏.
  * **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ó–º—ñ–Ω–Ω—ñ–π `top_words` –ø—Ä–∏—Å–≤–æ—é—î—Ç—å—Å—è —Å–ø–∏—Å–æ–∫, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:
    `[('—Å–ª–æ–≤–æ_–ê', 50), ('—Å–ª–æ–≤–æ_–ë', 45), ('—Å–ª–æ–≤–æ_–í', 30), ...]`

-----

**2. –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö (`zip` —Ç–∞ `*`)**


words, counts = zip(*top_words)
```

  * **`*top_words`**:
      * –ó—ñ—Ä–æ—á–∫–∞ (`*`) –ø–µ—Ä–µ–¥ —ñ–º–µ–Ω–µ–º —Å–ø–∏—Å–∫—É –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è **–æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è (unpacking operator)**.
      * –í–æ–Ω–∞ "—Ä–æ–∑–ø–∞–∫–æ–≤—É—î" —Å–ø–∏—Å–æ–∫ `top_words` –Ω–∞ –æ–∫—Ä–µ–º—ñ –∫–æ—Ä—Ç–µ–∂—ñ. –¢–æ–±'—î—Ç–æ, –∑–∞–º—ñ—Å—Ç—å –æ–¥–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É `[('—Å–ª–æ–≤–æ_–ê', 50), ('—Å–ª–æ–≤–æ_–ë', 45)]`, –≤–æ–Ω–∞ —Å—Ç–≤–æ—Ä—é—î –æ–∫—Ä–µ–º—ñ –∞—Ä–≥—É–º–µ–Ω—Ç–∏: `('—Å–ª–æ–≤–æ_–ê', 50)` —ñ `('—Å–ª–æ–≤–æ_–ë', 45)`.
  * **`zip(...)`**:
      * –§—É–Ω–∫—Ü—ñ—è `zip()` –ø—Ä–∏–π–º–∞—î –∫—ñ–ª—å–∫–∞ —ñ—Ç–µ—Ä–æ–≤–∞–Ω–∏—Ö –æ–±'—î–∫—Ç—ñ–≤ —ñ —Å—Ç–≤–æ—Ä—é—î –∑ –Ω–∏—Ö —ñ—Ç–µ—Ä–∞—Ç–æ—Ä –∫–æ—Ä—Ç–µ–∂—ñ–≤. –í–æ–Ω–∞ –≥—Ä—É–ø—É—î –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ —ñ–Ω–¥–µ–∫—Å–∞–º–∏.
      * –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É, `zip` –æ—Ç—Ä–∏–º—É—î `('—Å–ª–æ–≤–æ_–ê', 50)` —ñ `('—Å–ª–æ–≤–æ_–ë', 45)`.
      * –í–æ–Ω–∞ –±–µ—Ä–µ –ø–µ—Ä—à—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä—Ç–µ–∂—É —ñ –æ–±'—î–¥–Ω—É—î —ó—Ö (`'—Å–ª–æ–≤–æ_–ê'`, `'—Å–ª–æ–≤–æ_–ë'`).
      * –ü–æ—Ç—ñ–º –±–µ—Ä–µ –¥—Ä—É–≥—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ –∫–æ–∂–Ω–æ–≥–æ –∫–æ—Ä—Ç–µ–∂—É —ñ –æ–±'—î–¥–Ω—É—î —ó—Ö (`50`, `45`).
  * **–†–µ–∑—É–ª—å—Ç–∞—Ç**:
      * `zip` –ø–æ–≤–µ—Ä—Ç–∞—î —ñ—Ç–µ—Ä–∞—Ç–æ—Ä, —è–∫–∏–π –ø—ñ—Å–ª—è —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –Ω–∞ –¥–≤—ñ –∑–º—ñ–Ω–Ω—ñ —Å—Ç–≤–æ—Ä—é—î:
          * `words` = `('—Å–ª–æ–≤–æ_–ê', '—Å–ª–æ–≤–æ_–ë', '—Å–ª–æ–≤–æ_–í', ...)`
          * `counts` = `(50, 45, 30, ...)`
      * –¢–µ–ø–µ—Ä —É –≤–∞—Å —î –¥–≤–∞ –æ–∫—Ä–µ–º–∏—Ö —Å–ø–∏—Å–∫–∏ (–Ω–∞—Å–ø—Ä–∞–≤–¥—ñ, –∫–æ—Ä—Ç–µ–∂—ñ), —è–∫—ñ —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –≤ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—ó, –¥–µ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –±—É–¥–µ –ø—ñ–¥–ø–∏—Å–∞–º–∏ –¥–ª—è –æ—Å—ñ X, –∞ —ñ–Ω—à–∏–π ‚Äî –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –¥–ª—è –æ—Å—ñ Y.

### –°—Ö–µ–º–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

```markdown
1.  **–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ**: –§—É–Ω–∫—Ü—ñ—è `visualize_top_words` –æ—Ç—Ä–∏–º—É—î —Å–ª–æ–≤–Ω–∏–∫ `result` —Ç–∞ —á–∏—Å–ª–æ `top_n`.

2.  **–ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —á–∞—Å—Ç–æ—Ç**:
    * `Counter(result)` —Å—Ç–≤–æ—Ä—é—î –æ–±'—î–∫—Ç-–ª—ñ—á–∏–ª—å–Ω–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤—Ö—ñ–¥–Ω–æ–≥–æ —Å–ª–æ–≤–Ω–∏–∫–∞.
    * `most_common(top_n)` —Å–æ—Ä—Ç—É—î –µ–ª–µ–º–µ–Ω—Ç–∏ –∑–∞ —á–∞—Å—Ç–æ—Ç–æ—é —ñ –≤–∏–±–∏—Ä–∞—î `top_n` –Ω–∞–π—á–∞—Å—Ç—ñ—à–∏—Ö.
    * –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É –∑–º—ñ–Ω–Ω—ñ–π `top_words`.

3.  **–†–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –¥–ª—è `zip`**:
    * –û–ø–µ—Ä–∞—Ç–æ—Ä `*` —Ä–æ–∑–ø–∞–∫–æ–≤—É—î `top_words` –Ω–∞ –æ–∫—Ä–µ–º—ñ –∫–æ—Ä—Ç–µ–∂—ñ.

4.  **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä—Ç–µ–∂—ñ–≤**:
    * `zip()` –∑–±–∏—Ä–∞—î –ø–µ—Ä—à—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤—Å—ñ—Ö –∫–æ—Ä—Ç–µ–∂—ñ–≤ –≤ –æ–¥–∏–Ω –∫–æ—Ä—Ç–µ–∂ (`words`).
    * `zip()` –∑–±–∏—Ä–∞—î –¥—Ä—É–≥—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤—Å—ñ—Ö –∫–æ—Ä—Ç–µ–∂—ñ–≤ –≤ —ñ–Ω—à–∏–π –∫–æ—Ä—Ç–µ–∂ (`counts`).

5.  **–í–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ**:
    * `words` –º—ñ—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–ª—ñ–≤.
    * `counts` –º—ñ—Å—Ç–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —á–∞—Å—Ç–æ—Ç–∏.
    * –î–∞–ª—ñ —Ü—ñ –∑–º—ñ–Ω–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –≥—Ä–∞—Ñ—ñ–∫–∞.
```
'''

